<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:yuksekisler="http://java.sun.com/jsf/composite/yuksekisler">

<ui:composition template="/templates/mainlayout.xhtml">
	<ui:define name="container">
		<h:form id="mainForm" enctype="multipart/form-data">

			<yuksekisler:worksimpleform wc="#{workFormController}" isView="false"
				employeeController="#{employeeController}"/>
				
			<p:separator id="separator" />
			<p:panelGrid styleClass="borderlessPanel">
				<p:row>
					<p:column>
						<h:outputLabel for="selectedCategory"
							value="#{msgs.selectCategory}" />
					</p:column>
					<p:column>
						<p:selectOneMenu id="selectedCategory"
							value="#{workFormController.selectedCategory}">
							<f:selectItems value="#{equipmentViewController.categories}"
								var="category" itemLabel="#{category.name}"
								itemValue="#{category}" />
						</p:selectOneMenu>
					</p:column>
					<p:column>
						<p:commandButton action="#{workFormController.create}"
							value="#{msgs.create}" />
					</p:column>
					<p:column>
						<p:commandButton action="#{workFormController.cancel}"
							value="#{msgs.cancel}" immediate="true" />
					</p:column>
				</p:row>
				<p:row>
					<p:column colspan="3">
						<p:fieldset legend="Available Equipments!">
							<p:dataGrid id="dragArea" var="equipment"
								value="#{workFormController.availableCategories}" columns="3"
								rows="15" paginator="true" paginatorPosition="top"
								paginatorTemplate="{CurrentPageReport}  {PreviousPageLink} {PageLinks} {NextPageLink}"
								style="width:100%;border:none" styleClass="equipmentWidgetGrid">
								<p:column>
									<p:panelGrid id="equipment" styleClass="equipmentWidget">
										<p:row>
											<p:column rowspan="2">
												<c:choose>
													<c:when test="#{equipment.hasImage}">
														<h:graphicImage
															value="/images/image/#{equipment}/thumbnail" />
													</c:when>
													<c:otherwise>
														<h:graphicImage value="/resources/images/no-image-150.jpg"
															width="48" height="48" />
													</c:otherwise>
												</c:choose>
											</p:column>
											<p:column>
												<h:outputText value="#{equipment.productName}" />
											</p:column>
										</p:row>
										<p:row>
											<p:column>
												<h:outputText value="#{equipment.productCode}" />
											</p:column>
										</p:row>
									</p:panelGrid>
									<p:draggable for="equipment" revert="true" />
								</p:column>
							</p:dataGrid>
						</p:fieldset>
					</p:column>
					<p:column colspan="3">
						<p:fieldset id="selectedEquipments" legend="#{msgs.equipments}">
							<h:outputText value="!!!Drop here!!!"
								rendered="#{empty workFormController.work.equipments}"
								style="font-size:24px;" />
							<p:outputPanel id="dropArea">
								<p:dataGrid var="equipment"
									value="#{workFormController.work.equipments}" columns="3"
									style="width:100%;border:none" styleClass="equipmentWidgetGrid">
									<p:column>
										<p:panelGrid id="equipment" styleClass="equipmentWidget">
											<p:row>
												<p:column>
													<p:commandLink
														actionListener="#{workFormController.handleClose}"
														immediate="true"
														update=":mainForm:dropArea,:mainForm:dragArea">
														<f:attribute name="equipmentID" value="#{equipment.id}" />
														<div title=".ui-icon-trash"
															class="ui-state-default ui-corner-all"
															style="width: 24px; height: 16px">
															<span class="ui-icon ui-icon-trash"></span>
														</div>
													</p:commandLink>
												</p:column>
											</p:row>
											<p:row>
												<p:column rowspan="2">
													<c:choose>
														<c:when test="#{equipment.hasImage}">
															<h:graphicImage
																value="/images/image/#{equipment}/thumbnail" />
														</c:when>
														<c:otherwise>
															<h:graphicImage
																value="/resources/images/no-image-150.jpg" width="48"
																height="48" />
														</c:otherwise>
													</c:choose>
												</p:column>
												<p:column>
													<h:outputText value="#{equipment.productName}" />
												</p:column>
											</p:row>
											<p:row>
												<p:column>
													<h:outputText value="#{equipment.productCode}" />
												</p:column>
											</p:row>
										</p:panelGrid>
									</p:column>
								</p:dataGrid>
							</p:outputPanel>
						</p:fieldset>
						<p:droppable for="selectedEquipments" tolerance="touch"
							activeStyleClass="ui-state-highlight" datasource="dragArea"
							onDrop="handleDrop">

							<p:ajax listener="#{workFormController.onEquipmentDrop}"
								update="dragArea dropArea" />
						</p:droppable>
					</p:column>
				</p:row>
			</p:panelGrid>
		</h:form>
		<script type="text/javascript">
			function handleDrop(event, ui) {
				ui.draggable.fadeOut('fast');
			}
		</script>
	</ui:define>
</ui:composition>
</html>